%% LyX 2.1.3 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[english]{article}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage{geometry}
\geometry{verbose,tmargin=3cm,bmargin=3cm,lmargin=3cm,rmargin=3cm}
\usepackage{amsmath}
\usepackage{esint}
\usepackage{babel}
\begin{document}

\subsection*{Theorem 1 }

Suppose we have sub-gauss errors.

Suppose 
\[
\int_{0}^{R}H{}^{1/2}(u,\mathcal{G}(T),\|\cdot\|_{V})du\le\psi_{T}(R)
\]


Suppose

\[
\frac{\psi_{T}\left(a+u\right)}{u^{2}}
\]


are nonincreasing wrt to $u$ for all $u>0,a>0$.

Then for all $\delta>0$ s.t. 
\[
\sqrt{n_{V}}\delta^{2}\ge c\left[\psi_{T}\left(2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2\delta\right)\vee\left(2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2\delta\right)\right]
\]


With high probability
\[
\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}\le\|\hat{g}_{\tilde{\lambda}}-g^{*}\|_{V}+\delta
\]



\subsubsection*{Proof for Theorem 1}

The basic inequality gives us 

\[
\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}^{2}\le\|\hat{g}_{\tilde{\lambda}}(\cdot|T)-g^{*}\|_{V}^{2}+2\langle\epsilon,\hat{g}_{\hat{\lambda}}-\hat{g}_{\tilde{\lambda}}\rangle_{V}
\]


Note that if $\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}\le\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}$,
then 
\begin{eqnarray*}
\left(\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}-\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}\right)^{2} & \le & \left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}^{2}
\end{eqnarray*}


By a peeling argument, we have
\begin{eqnarray*}
 &  & Pr\left(\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}-\|\hat{g}_{\tilde{\lambda}}-g^{*}\|_{V}\ge\delta\right)\\
 & = & \sum_{s=0}^{\infty}Pr\left(2^{s}\delta\le\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}-\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}\le2^{s+1}\delta\right)\\
 & \le & \sum_{s=0}^{\infty}Pr\left(\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}-\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}\ge2^{s}\delta\wedge\left\Vert \hat{g}_{\hat{\lambda}}-\hat{g}_{\tilde{\lambda}}\right\Vert _{V}\le2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\\
 & = & \sum_{s=0}^{\infty}Pr\left(\left(\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}-\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}\right)^{2}\ge2^{2s}\delta^{2}\wedge\left\Vert \hat{g}_{\hat{\lambda}}-\hat{g}_{\tilde{\lambda}}\right\Vert _{V}\le2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\\
 & \le & \sum_{s=0}^{\infty}Pr\left(\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}^{2}\ge2^{2s}\delta^{2}\wedge\left\Vert \hat{g}_{\hat{\lambda}}-\hat{g}_{\tilde{\lambda}}\right\Vert _{V}\le2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\\
 & \le & \sum_{s=0}^{\infty}Pr\left(\sup_{\left\Vert \hat{g}_{\lambda}-\hat{g}_{\tilde{\lambda}}\right\Vert _{V}\le2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2^{s+1}\delta}\langle\epsilon,\hat{g}_{\tilde{\lambda}}-\hat{g}_{\lambda}\rangle_{V}\ge2^{2s-1}\delta^{2}\right)
\end{eqnarray*}


To apply the lemma based on vandegeer corollary 8.3 (see below), we
must check that $\delta$ satisfies all the conditions. By our choice
of $\delta$ and the fact that $\psi(a+u)/u$ is nonincreasing, we
have that for for all $s$

\[
\sqrt{n_{V}}2^{2s-1}\delta^{2}\ge c\left[\psi_{T}\left(2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\vee\left(2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\right]
\]


So by the lemma below, we have
\begin{eqnarray*}
 &  & Pr\left(\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}-\|\hat{g}_{\tilde{\lambda}}-g^{*}\|_{V}\ge\delta\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)\\
 & \le & C\sum_{s=0}^{\infty}\exp\left(-n_{V}\frac{2^{4s-2}\delta^{4}}{4C^{2}\left(2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)^{2}}\right)\\
 & \le & C\sum_{s=0}^{\infty}\exp\left(-n_{V}\frac{2^{4s-2}\delta^{4}}{64C^{2}\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}^{2}}\right)\vee\exp\left(-n_{V}\frac{2^{2s}\delta^{2}}{196C^{2}}\right)\\
 & \le & c\exp\left(-\frac{n_{V}\delta^{4}}{c^{2}\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}^{2}}\right)+c\exp\left(-\frac{n_{V}\delta^{2}}{c^{2}}\right)
\end{eqnarray*}


for some constant $c$.

By Bernstein's inequality, we also know
\[
Pr\left(\|\epsilon\|_{T}\ge2\sigma\right)\le\exp\left(-n_{T}\frac{\sigma^{2}}{K}\right)
\]


and similarly for $Pr\left(\|\epsilon\|_{V}\ge2\sigma\right)$.

Hence we have found for the given $\delta$ choice, we have

\begin{eqnarray*}
 &  & Pr\left(\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}-\|\hat{g}_{\tilde{\lambda}}-g^{*}\|_{V}\ge\delta\right)\\
 & \le & c\exp\left(-\frac{n_{V}\delta^{4}}{c^{2}\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}^{2}}\right)+c\exp\left(-\frac{n_{V}\delta^{2}}{c^{2}}\right)+\exp\left(-n_{T}\frac{\sigma^{2}}{K}\right)+\exp\left(-n_{V}\frac{\sigma^{2}}{K}\right)
\end{eqnarray*}



\subsection*{Corollary to Theorem 1}

Let $\Lambda=[n^{-t_{min}},n^{t_{max}}]^{J}$.

Suppose that if $\|\epsilon\|_{T}\le2\sigma$, there are constants
$C,\kappa$ such that for any $u>0$, we have for all $\lambda\in\Lambda$
\[
\|\boldsymbol{\lambda}_{1}-\boldsymbol{\lambda}_{2}\|\le Cn^{\kappa}u^{2}\implies\|\hat{g}_{\boldsymbol{\lambda}_{1}}-\hat{g}_{\boldsymbol{\lambda}_{2}}\|_{V}\le u
\]


Then there are constants $c_{1},c_{2}$ s.t. with high probability,
\[
\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}\le\|\hat{g}_{\tilde{\lambda}}-g^{*}\|_{V}+\frac{c_{1}\left(J(\log n_{V}+c_{2})\right)^{1/2}}{\sqrt{n_{V}}}+\sqrt{c\left(J(\log n_{V}+c_{2})\right)^{1/2}\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}n_{V}^{-1/2}}
\]



\subsubsection*{Proof}

By Lemma param\_covering\_cube, we have
\[
H(u,\mathcal{G}(T),\|\cdot\|_{V})\le\log\frac{1}{C_{J}}+J\log\left(\frac{2n^{t_{max}-\kappa}+2Cu^{2}}{Cu^{2}}\right)
\]


Let $R_{1}=R\wedge\sqrt{n^{t_{max}-\kappa}/C}$.

Then
\begin{eqnarray*}
\int_{0}^{R}H{}^{1/2}(u,\mathcal{G}(T),\|\cdot\|_{V})du & \le & \int_{0}^{R}\left[\log\frac{1}{C_{J}}+J\log\left(\frac{2n^{t_{max}-\kappa}+2Cu^{2}}{Cu^{2}}\right)\right]^{1/2}du\\
 & < & \int_{0}^{R}\left[\log\frac{1}{C_{J}}+J\log4+J\log\left(\frac{4n^{t_{max}-\kappa}}{Cu^{2}}\right)\right]^{1/2}du\\
 & = & R\int_{0}^{1}\left[\log\frac{1}{C_{J}}+J\log4+J\log\left(\frac{4n^{t_{max}-\kappa}}{CR^{2}v^{2}}\right)\right]^{1/2}dv\\
 & \le & R\left[\int_{0}^{1}\log\frac{1}{C_{J}}+J\log4+J\log\left(\frac{4n^{t_{max}-\kappa}}{CR^{2}v^{2}}\right)dv\right]^{1/2}\\
 & = & R\left[\log\frac{1}{C_{J}}+J(2+\log4)+J\log\left(\frac{4n^{t_{max}-\kappa}}{C}\right)+2J\log\frac{1}{R}\right]^{1/2}\\
 & \le & R\left(\left[\log\frac{1}{C_{J}}+J(2+\log4)+J\log\left(\frac{4n^{t_{max}-\kappa}}{C}\right)\right]^{1/2}+\sqrt{2J\log\frac{1}{R}\vee0}\right)
\end{eqnarray*}


The second bound is crazy loose (but is okay I think). The third inequality
follows from concavity of the square root.

The term $\log\frac{1}{R}$ is nasty. When choosing $\delta$, we
will replace it with $\sqrt{\log n_{V}}$ since for all $R\in[\frac{1}{n_{V}},1]$,
we have 
\[
\sqrt{\log\frac{1}{R}}\le\sqrt{\log n_{V}}
\]


Hence it suffices to choose $\delta$ s.t. 
\[
\sqrt{n_{V}}\delta^{2}\ge c\left(\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+\delta\right)\left(\left[\log\frac{1}{C_{J}}+J(2+\log4)+J\log\left(\frac{4n^{t_{max}-\kappa}}{C}\right)\right]^{1/2}+\sqrt{2J\log n_{V}}\right)
\]


Let 
\[
K=c\left(\left[\log\frac{1}{C_{J}}+J(2+\log4)+J\log\left(\frac{4n^{t_{max}-\kappa}}{C}\right)\right]^{1/2}+\sqrt{2J\log n_{V}}\right)
\]


and 
\[
\omega=\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}
\]


So we are interested in $\delta$ s.t.

\[
\sqrt{n_{V}}\delta^{2}-K\delta-K\omega\ge0
\]


The quadratic formula tells us that this is satisfied when

\[
\delta\ge\frac{K+\sqrt{K^{2}+4K\omega\sqrt{n_{V}}}}{2\sqrt{n_{V}}}
\]


A more simple lower bound for $\delta$ is
\[
\delta\ge\frac{K}{\sqrt{n_{V}}}+\sqrt{K\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}n_{V}^{-1/2}}
\]



\subsection*{Lemma (Based on Vandegeer Corollary 8.3)}

Let $Q_{m}$ be the empirical distributon of $m$ observations at
covariates $x_{i}$.

Suppose $\epsilon$ are $m$ independent sub-gaussian errors. Suppose
the model class $\mathcal{F}(T)$ has elements $\sup_{f\in\mathcal{F}_{n}(T)}\|f\|_{Q_{m}}\le R$
and satisfies
\[
\psi_{T}(R)\ge\int_{0}^{R}H^{1/2}(u,\mathcal{F}(T),\|\cdot\|_{Q_{m}})du
\]


There is $C$ dependent only on the sub-gaussian constants such that
for all $\delta>0$ such that
\[
\sqrt{m}\delta\ge C(\psi_{T}(R)\vee R)
\]


we have 
\[
Pr\left(\sup_{f\in\mathcal{F}_{n}(T)}\left|\frac{1}{m}\sum_{i=1}^{m}\epsilon_{i}f(x_{i})\right|\ge\delta\wedge\|\epsilon\|_{Q_{m}}\le2\sigma\right)\le C\exp\left(-\frac{m\delta^{2}}{4C^{2}R^{2}}\right)
\]



\subsection*{Lemma param\_covering\_cube}

Suppose we have $\Lambda=[\lambda_{min},\lambda_{max}]^{J}$, we have
\[
N(\delta,\Lambda,\|\cdot\|_{2})\le\frac{1}{C_{J}}\left(\frac{2(\lambda_{max}-\lambda_{min})+2\delta}{\delta}\right)^{J}
\]



\subsubsection*{Proof}

(Based on Lemma 2.5 in vandegeer)

Let $C=\{c_{j}\}_{j=1}^{N}\subset\Lambda$ be the largest set s.t.
two distinct points $c_{j_{1}},c_{j_{2}}$ are at least $\delta$
apart. Then balls with radius $\delta$ centered at $C$ cover $\Lambda$.

If the balls have radius $\delta/4$ and are centered at $C$, then
the balls must be disjoint and are completely contained in the box
$[\lambda_{min}-\delta/4,\lambda_{max}+\delta/4]^{J}$.

The volume of a ball with radius $\rho$ is $C_{J}\rho^{J}$. Therefore
\[
NC_{J}(\delta/4)^{J}\le(\lambda_{max}-\lambda_{min}+\delta/2)^{J}
\]

\end{document}
