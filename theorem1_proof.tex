%% LyX 2.1.3 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[english]{article}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage[landscape]{geometry}
\geometry{verbose,tmargin=3cm,bmargin=3cm,lmargin=3cm,rmargin=3cm}
\usepackage{amsbsy}
\usepackage{esint}
\usepackage{babel}
\begin{document}

\title{Training/Validation Split Theorem}

\maketitle
We are interested in bounding the error of the selected model when
tuning penalty parameters by a training validation split. We will
concern ourselves with the error over the observed covariates in the
validation set. Under sufficient entropy conditions, the error of
the selected model will converge to the error of the oracle. 

We will suppose that the data is generated from the model:
\[
y=g^{*}(x)+\epsilon
\]


where $\epsilon$ are independent, sub-gaussian errors. The penalized
regression models are 
\[
\hat{g}(\cdot|\boldsymbol{\lambda})=\arg\min_{g\in\mathcal{G}}L_{T}(g|\boldsymbol{\lambda})
\]


Let the model class after fitting on the training data be 
\[
\mathcal{G}(T)=\left\{ \hat{g}(\cdot|\boldsymbol{\lambda}):\boldsymbol{\lambda}\in\Lambda\right\} 
\]


The selected penalty parameters are
\[
\hat{\boldsymbol{\lambda}}=\arg\min_{\boldsymbol{\lambda}\in\Lambda}\left\Vert y-\hat{g}(\cdot|\boldsymbol{\lambda})\right\Vert _{V}^{2}
\]


Suppose the ``oracle'' penalty parameters are 
\[
\tilde{\boldsymbol{\lambda}}=\arg\min_{\boldsymbol{\lambda}\in\Lambda}\|\hat{g}(\cdot|\boldsymbol{\lambda})-g^{*}\|_{V}
\]


We will provide sharp oracle inequalities of the form
\[
\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\le\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+\delta
\]


The document is organized as follows
\begin{enumerate}
\item Theorem 3 proves the training/validation split under general entropy
conditions. 
\item Theorem 1 applies Theorem 3 to the special case when the fitted functions
are Lipschitz in the penalty parameters
\item Understand the behavior of the oracle error $\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}$
\end{enumerate}

\section{Theorem 3}

Let $r>0$. Suppose that if $\|\epsilon\|_{T}\le2\sigma$, then $\mathcal{G}(T)$
satisfies the entropy condition 
\[
\int_{0}^{R}H{}^{1/2}(u,\mathcal{G}(T),\|\cdot\|_{V})du\le\min\left\{ \tilde{\psi_{T}}(R),\psi_{T}(R)\right\} 
\]


for all $R>r$.

Furthermore, suppose that

\[
\frac{\psi_{T}\left(u\right)}{u^{2}}
\]


is nonincreasing wrt to $u$ for all $u>r$.

Then there is some constant $C$ (only dependent on the characteristics
of the sub-gassian errors) such that for all $\delta>r$ with
\[
\sqrt{n_{V}}\delta^{2}\ge C\left(\psi_{T}\left(\delta\right)\vee\delta\vee\tilde{\psi_{T}}\left(4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\right)\vee4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\right)
\]


we have
\begin{eqnarray*}
Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}\ge\delta^{2}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right) & \le & c\exp\left(-\frac{n_{V}\delta^{4}}{c^{2}\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}}\right)+c\exp\left(-\frac{n_{V}\delta^{2}}{c^{2}}\right)
\end{eqnarray*}


for a constant $c>0$.


\subsubsection*{Proof}

We use the usual peeling argument
\begin{eqnarray*}
 &  & Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}\ge\delta^{2}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)\\
 & = & \sum_{s=0}^{\infty}Pr\left(2^{2s}\delta^{2}\le\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}\le2^{2s+2}\delta^{2}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)\\
 & \le & \sum_{s=0}^{\infty}Pr\left(2^{2s}\delta^{2}\le2\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}\wedge\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}\le2^{2s+2}\delta^{2}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)\\
 & = & \sum_{s=0}^{\infty}Pr\left(2^{2s}\delta^{2}\le2\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}\wedge\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}^{2}+2\left\langle \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-\hat{g}(\cdot|\hat{\boldsymbol{\lambda}}),\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\rangle _{V}\le2^{2s+2}\delta^{2}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)\\
 & \le & \sum_{s=0}^{\infty}Pr\left(2^{2s}\delta^{2}\le2\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}\wedge\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}^{2}\le2^{2s+2}\delta^{2}+2\left|\left\langle \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-\hat{g}(\cdot|\hat{\boldsymbol{\lambda}}),\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\rangle _{V}\right|\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)
\end{eqnarray*}


We can split each probability into the case where $2^{2s+2}\delta^{2}$
or $2\left|\left\langle \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-\hat{g}(\cdot|\hat{\boldsymbol{\lambda}}),\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\rangle _{V}\right|$
is bigger: 
\begin{eqnarray*}
 &  & Pr\left(2^{2s}\delta^{2}\le2\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}\wedge\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}^{2}\le2^{2s+2}\delta^{2}+2\left|\left\langle \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-\hat{g}(\cdot|\hat{\boldsymbol{\lambda}}),\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\rangle _{V}\right|\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)\\
 & \le & Pr\left(2^{2s}\delta^{2}\le2\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}\wedge\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}^{2}\le4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)\\
 &  & +Pr\left(2^{2s}\delta^{2}\le2\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}\wedge\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}^{2}\le2^{2s+3}\delta^{2}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)\\
 & \le & Pr\left(\sup_{\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\le4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}}2^{2s}\delta^{2}\le2\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)\\
 &  & +Pr\left(\sup_{\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\le2^{s+3/2}\delta}2^{2s}\delta^{2}\le2\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)
\end{eqnarray*}


Hence 
\begin{eqnarray*}
Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}\ge\delta^{2}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right) & \le & Pr\left(\sup_{\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\le4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}}\delta^{2}\le2\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)\\
 &  & +\sum_{s=0}^{\infty}Pr\left(\sup_{\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\le2^{s+3/2}\delta}2^{2s}\delta^{2}\le2\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)
\end{eqnarray*}


If $\|\epsilon\|_{T}\le2\sigma$, then we have the entropy condition
that 
\[
\int_{0}^{R}H{}^{1/2}(u,\mathcal{G}(T),\|\cdot\|_{V})du\le\tilde{\psi_{T}}(R)
\]


Vandegeer Corollary 8.3 bounds the first probability by

\[
Pr\left(\sup_{\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\le4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}}\delta^{2}\le2\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)\le c\exp\left(-\frac{n_{V}\delta^{4}}{4c^{2}\left(16\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}\right)}\right)
\]


for some $c>0$ if $\delta>0$ satisfies

\[
\sqrt{n_{V}}\delta^{2}\ge C\left(\tilde{\psi_{T}}(4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V})\vee4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\right)
\]


We also bound the summation using Vandegeer Corollary 8.3. Recall
that if $\|\epsilon\|_{T}\le2\sigma$, then we have the entropy condition
that 
\[
\int_{0}^{R}H{}^{1/2}(u,\mathcal{G}(T),\|\cdot\|_{V})du\le\psi_{T}(R)
\]


So we will apply Vandegeer Corollary 8.3 to bound the empirical process
assuming that $\|\epsilon\|_{T}\le2\sigma$. First we check the condition
for Corollary 8.3 is satisfied. In particular, we need to show that
for all $s=0,1,2,...$ 
\begin{eqnarray*}
\sqrt{n_{V}}2^{2s+2}\delta^{2} & \ge & C\left(\psi_{T}\left(2^{s+1}\delta\right)\vee\delta\right)
\end{eqnarray*}


This is true since we chose $\delta$ such that 
\begin{eqnarray*}
\sqrt{n_{V}}\delta^{2} & \ge & C\left(\psi_{T}\left(\delta\right)\vee\delta\right)
\end{eqnarray*}


and we assumed that $\psi_{T}(u)/u^{2}$ is nonincreasing for all
$u$.

So Corollary 8.3 states that for all $s=0,1,...$
\[
Pr\left(\sup_{\lambda,\lambda':\left\Vert \hat{g}(\cdot|\lambda)-\hat{g}(\cdot|\lambda')\right\Vert _{V}\le2^{s+3/2}\delta}\left\langle \epsilon,\hat{g}(\cdot|\boldsymbol{\lambda})-\hat{g}(\cdot|\boldsymbol{\lambda}')\right\rangle _{V}\ge2^{2s-1}\delta^{2}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)\le\exp\left(-n_{V}\frac{2^{4s-2}\delta^{4}}{4C^{2}2^{2s+3}\delta^{2}}\right)
\]


Putting this together, for all 
\[
\sqrt{n_{V}}\delta^{2}\ge C\left(\psi_{T}\left(\delta\right)\vee\delta\vee\tilde{\psi_{T}}\left(4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\right)\vee4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\right)
\]
 exists some constant $c$ such that
\begin{eqnarray*}
Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}\ge\delta^{2}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right) & \le & c\exp\left(-\frac{n_{V}\delta^{4}}{c^{2}\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}}\right)+c\exp\left(-\frac{n_{V}\delta^{2}}{c^{2}}\right)
\end{eqnarray*}



\section{Theorem 1}

Let $\Lambda=[\lambda_{min},\lambda_{max}]^{J}$.

Suppose that if $\|\epsilon\|_{T}\le2\sigma$, there is a constant
$C>0$ such that for all $\boldsymbol{\lambda}_{1},\boldsymbol{\lambda}_{2}\in\Lambda$
\[
\left\Vert \hat{g}(\cdot|\boldsymbol{\lambda}^{(1)})-\hat{g}(\cdot|\boldsymbol{\lambda}^{(2)})\right\Vert _{V}\le C\|\boldsymbol{\lambda}_{1}-\boldsymbol{\lambda}_{2}\|
\]


Then for any $\delta>1/n_{V}$ such that

\[
\delta\ge\alpha_{1}\frac{1}{\sqrt{n_{V}}}\vee\alpha_{2}\sqrt{\frac{1}{\sqrt{n_{V}}}\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}}
\]


where 
\[
\alpha_{1}=2C_{0}\left[\left[\log\frac{1}{C_{J}}+J(1+\log4+\log8C)+J\log\left(\lambda_{max}-\lambda_{min}\right)+J\log n_{V}\right]^{1/2}\vee1\right]
\]


and 
\[
\alpha_{2}^{2}=8C_{0}\left[\left[\log\frac{1}{C_{J}}+J(1+\log4+\log8C)+J\log\left(\lambda_{max}-\lambda_{min}\right)-J\log\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}\right]^{1/2}\vee1\right]
\]


and $C_{J}$ is a universal constant, we have

\begin{eqnarray*}
Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\ge\delta\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right) & \le & c\exp\left(-\frac{n_{V}\delta^{4}}{c^{2}\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}}\right)+c\exp\left(-\frac{n_{V}\delta^{2}}{c^{2}}\right)
\end{eqnarray*}


for some constant $c>0$.


\subsubsection*{Proof}

\textbf{1. Determine entropy bound and properties}

Under the given Lipschitz condition, a $\delta$-cover for $\Lambda$
is a $C\delta$-cover for $\mathcal{G}(T)$. We can therefore calculate
a covering number for $\mathcal{G}(T)$ wrt $\|\cdot\|_{V}$ by using
the covering number for $\Lambda$. 
\[
N\left(u,\mathcal{G}(T),\|\cdot\|_{V}\right)\le N\left(\frac{u}{C},\Lambda,\|\cdot\|_{2}\right)
\]


By Lemma param\_covering\_cube (See Appendix), we know that
\begin{eqnarray*}
N\left(u,\Lambda,\|\cdot\|_{2}\right) & \le & \frac{1}{C_{J}}\left(\frac{4\left(\lambda_{max}-\lambda_{min}\right)+2\frac{u}{C}}{\frac{u}{C}}\right)^{J}\\
 & = & \frac{1}{C_{J}}\left(\frac{4\left(\lambda_{max}-\lambda_{min}\right)C+2u}{u}\right)^{J}\\
 & \le & \frac{1}{C_{J}}\left(\frac{4C\left(\lambda_{max}-\lambda_{min}\right)+2u}{u}\right)^{J}
\end{eqnarray*}


Hence
\[
H(u,\mathcal{G}(T),\|\cdot\|_{V})\le\log\left[\frac{1}{C_{J}}\left(\frac{4C\left(\lambda_{max}-\lambda_{min}\right)+2u}{u}\right)^{J}\right]
\]


Then

\begin{eqnarray*}
\int_{0}^{R}H{}^{1/2}(u,\mathcal{G}(T),\|\cdot\|_{V})du & \le & \int_{0}^{R}\left[\log\frac{1}{C_{J}}+J\log\left(\frac{4C\left(\lambda_{max}-\lambda_{min}\right)+2u}{u}\right)\right]^{1/2}du\\
 & \le & \int_{0}^{R}\left[\log\frac{1}{C_{J}}+J\log4+J\log\left(\frac{8C\left(\lambda_{max}-\lambda_{min}\right)}{u}\right)\right]^{1/2}du\\
 & = & R\int_{0}^{1}\left[\log\frac{1}{C_{J}}+J\log4+J\log\left(\frac{8C\left(\lambda_{max}-\lambda_{min}\right)}{Rv}\right)\right]^{1/2}dv\\
 & \le & R\left[\int_{0}^{1}\log\frac{1}{C_{J}}+J\log4+J\log\left(\frac{8C\left(\lambda_{max}-\lambda_{min}\right)}{R}\right)+J\log\frac{1}{v}dv\right]^{1/2}\\
 & = & R\left[\log\frac{1}{C_{J}}+J(1+\log4+\log8C)+J\log\left(\lambda_{max}-\lambda_{min}\right)+J\log\frac{1}{R}\right]^{1/2}
\end{eqnarray*}


The second bound is crazy loose but I think it is okay. It comes from
the fact that 
\[
\log\left(a+b\right)<\log\left(2a\right)+\log(2b)
\]


The third inequality follows from concavity of the square root.

We will consider the following two bounds for $\int_{0}^{R}H{}^{1/2}(u,\mathcal{G}(T),\|\cdot\|_{V})du$:

\[
\tilde{\psi_{T}}(R)=R\left[\log\frac{1}{C_{J}}+J(1+\log4+\log8C)+J\log\left(\lambda_{max}-\lambda_{min}\right)+J\log\frac{1}{R}\right]^{1/2}\mbox{ for all }R\ge0
\]


and
\[
\psi_{T}(R)=R\left[\log\frac{1}{C_{J}}+J(1+\log4+\log8C)+J\log\left(\lambda_{max}-\lambda_{min}\right)+J\log n_{V}\right]^{1/2}\mbox{ for all }R\ge n_{V}^{-1}
\]


The second bound replaces the last term $\log\frac{1}{R}$ was replaced
with $\log n_{V}$, which is valid over the given range. We will see
this is useful since solving for $\delta$ is hard with the $\log\frac{1}{R}$
term.

\textbf{2. Apply Theorem 3}

By Theorem 3, there is a constant $C_{0}>0$ such that the oracle
inequality 
\[
\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}\ge\delta^{2}
\]


holds with probability $p(\delta)$ for all $\delta>0$ such that
\[
\sqrt{n_{V}}\delta^{2}\ge C\left(\psi_{T}\left(\delta\right)\vee\delta\vee\tilde{\psi_{T}}\left(4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\right)\vee4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\right)
\]


We will solve this by splitting into cases.

\textbf{Case 1: }Suppose that 
\[
\psi_{T}\left(\delta\right)\vee\delta\ge\tilde{\psi_{T}}\left(4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\right)\vee4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}
\]


Then Theorem 3 holds for any $\delta>1/n_{V}$ such that

\[
\delta\ge\frac{1}{\sqrt{n_{V}}}\alpha_{1}
\]


where 
\[
\alpha_{1}=2C_{0}\left[\left[\log\frac{1}{C_{J}}+J(1+\log4+\log8C)+J\log\left(\lambda_{max}-\lambda_{min}\right)+J\log n_{V}\right]^{1/2}\vee1\right]
\]


\textbf{Case 2:}

Suppose that 
\[
\psi_{T}\left(\delta\right)\vee\delta\le\tilde{\psi_{T}}\left(4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\right)\vee4\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}
\]


Then we need to find a $\delta>1/n_{V}$ such that

\[
\delta^{2}\ge\frac{1}{\sqrt{n_{V}}}\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}\alpha_{2}^{2}
\]


where 
\[
\alpha_{2}^{2}=8C_{0}\left[\left[\log\frac{1}{C_{J}}+J(1+\log4+\log8C)+J\log\left(\lambda_{max}-\lambda_{min}\right)-J\log\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}\right]^{1/2}\vee1\right]
\]


Putting these two inequalities together, we get that
\[
\delta\ge\alpha_{1}\frac{1}{\sqrt{n_{V}}}\vee\alpha_{2}\sqrt{\frac{1}{\sqrt{n_{V}}}\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}}
\]



\section{Lemma 1 with $\lambda$ changing with $n$}

We will express this using asymptotic notation.

Let $\Lambda=[n_{T}^{-t_{min}},n_{T}^{t_{max}}]^{J}$.

Suppose that if $\|\epsilon\|_{T}\le2\sigma$, there are constants
$C,\kappa$ such that for any $u>0$, we have for all $\lambda\in\Lambda$
\[
\left\Vert \hat{g}(\cdot|\boldsymbol{\lambda}^{(1)})-\hat{g}(\cdot|\boldsymbol{\lambda}^{(2)})\right\Vert _{V}\le Cn_{T}^{\kappa}\|\boldsymbol{\lambda}_{1}-\boldsymbol{\lambda}_{2}\|
\]


Then

\begin{eqnarray*}
\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V} & \le & \left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+O_{p}\left(\left[\frac{c_{J}+J(\kappa+t_{max})\log n_{T}+J\log n_{V}}{n_{V}}\right]^{1/2}\vee\sqrt{\left[\frac{c_{J}+J(\kappa+t_{max})\log n_{T}-J\log\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}}{n_{V}}\right]^{1/2}\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}}\right)
\end{eqnarray*}



\section{Understanding the behavior of the oracle error}

All of the oracle inequalities that we have derived use the oracle
error over the validation observations, $\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}$
, as an upper bound. Intuitively, one would think that the oracle
error $\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}$
is small, but we did not prove this earlier. We are interested in
showing that this quantity is small if $\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert $
is small. To do this, we use Theorem 2.1 in Vandegeer (from the paper
On the uniform convergence...). Note that$\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert $
is valid to use in the upper bound since Mitchell's paper also uses
this value.

Consider the function class composed of just the single function:
\[
\mathcal{G}(T)=\left\{ \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\} 
\]


We note that this function class is dependent on the training data
but independent of validation set.

Since this class contains a single function, its entropy is zero.

Suppose that 
\[
K=\|\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\|_{\infty}
\]


Then by Theorem 2.1, for any $t>0$, we can bound the conditional
probability (training set $T$ is given)
\[
Pr\left(\left.\frac{1}{C_{1}}\left|\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert ^{2}\right|\le\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert K\sqrt{\frac{t}{n_{V}}}+\frac{K^{2}t}{n_{V}}\right|T\right)\le1-\exp(-t)
\]


where $C_{1}$ is a constant given in the theorem. Rearranging the
inequality can give us a better understanding of $\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}$:
\begin{eqnarray*}
\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2} & \le & \left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert ^{2}+C_{1}\left(\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert K\sqrt{\frac{t}{n_{V}}}+\frac{K^{2}t}{n_{V}}\right)\\
 & \le & \left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert ^{2}+2C_{1,m}\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert K\sqrt{\frac{t}{n_{V}}}+C_{1,m}^{2}\frac{K^{2}t}{n_{V}}\\
 & = & \left(\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert +C_{1,m}K\sqrt{\frac{t}{n_{V}}}\right)^{2}
\end{eqnarray*}


where $C_{1,m}=\max\left(C_{1},0\right)$. Then 
\begin{eqnarray*}
\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V} & \le & \left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert +C_{1,m}K\sqrt{\frac{t}{n_{V}}}
\end{eqnarray*}


So we have indeed shown that $\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}$
is small when $\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert $
is small.

Combining this result with our inequality bounds from Sections 1 and
2, we get that with high probability 
\begin{eqnarray*}
\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V} & \le & \left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert +C_{1,m}K\sqrt{\frac{t}{n_{V}}}+\mbox{additional error}
\end{eqnarray*}



\section{Appendix}


\subsection*{Lemma Vandegeer (Based on Vandegeer Corollary 8.3)}

(This lemma is directly out of Vandegeer's Empirical Process book.)

Let $Q_{m}$ be the empirical distributon of $m$ observations at
covariates $x_{i}$.

Suppose $\epsilon$ are $m$ independent sub-gaussian errors. Suppose
the model class $\mathcal{F}(T)$ has elements $\sup_{f\in\mathcal{F}_{n}(T)}\|f\|_{Q_{m}}\le R$
and satisfies
\[
\psi_{T}(R)\ge\int_{0}^{R}H^{1/2}(u,\mathcal{F}(T),\|\cdot\|_{Q_{m}})du
\]


There is $C$ dependent only on the sub-gaussian constants such that
for all $\delta>0$ such that
\[
\sqrt{m}\delta\ge C(\psi_{T}(R)\vee R)
\]


we have 
\[
Pr\left(\sup_{f\in\mathcal{F}_{n}(T)}\left|\frac{1}{m}\sum_{i=1}^{m}\epsilon_{i}f(x_{i})\right|\ge\delta\wedge\|\epsilon\|_{Q_{m}}\le\sigma\right)\le C\exp\left(-\frac{m\delta^{2}}{4C^{2}R^{2}}\right)
\]



\subsection*{Lemma param\_covering\_cube}

Suppose $\Lambda=[\lambda_{min},\lambda_{max}]^{J}$. Then the $\delta$-covering
number is bounded as follows 
\[
N(\delta,\Lambda,\|\cdot\|_{2})\le\frac{1}{C_{J}}\left(\frac{4(\lambda_{max}-\lambda_{min})+2\delta}{\delta}\right)^{J}
\]


where $C_{J}=\frac{\mbox{volume of ball of radius }\rho}{\rho^{J}}=\frac{\pi^{J/2}}{\Gamma(\frac{J}{2}+1)}$.


\subsubsection*{Proof}

(Essentially the same proof as that for Lemma 2.5 in vandegeer)

Let $C=\{c_{j}\}_{j=1}^{N}\subset\Lambda$ be the largest set s.t.
two distinct points $c_{j_{1}},c_{j_{2}}$ are at least $\delta$
apart. Then balls with radius $\delta$ centered at $C$ cover $\Lambda$.
Hence 
\[
N(\delta,\Lambda,\|\cdot\|_{2})\le N
\]


If we instead consider the balls centered at $C$ but with radius
$\delta/4$, all of these smaller balls must be disjoint and are completely
contained in the box $\Lambda_{bigger}=[\lambda_{min}-\delta/4,\lambda_{max}+\delta/4]^{J}$.
So we know the aggregate volume of these smaller balls is less than
the volume of $\Lambda_{bigger}$.

Hence
\[
NC_{J}(\delta/4)^{J}\le(\lambda_{max}-\lambda_{min}+\delta/2)^{J}
\]



\subsection*{Lemma psuedo-basic inequality}

Suppose 
\[
\left\Vert y-\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})\right\Vert _{V}^{2}\le\left\Vert y-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}^{2}
\]


Suppose for all samples $i$ in dataset $V$, we have 
\[
y_{i}=g^{*}(x_{i})+\epsilon_{i}
\]


then

\[
2\left\langle g^{*}-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}}),\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})\right\rangle _{V}+\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})\right\Vert _{V}^{2}\le2\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}
\]



\subsubsection*{Proof}

From the definition, we have that


\subsubsection*{
\begin{eqnarray*}
\left\Vert y-\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})\right\Vert _{V}^{2} & = & \left\Vert y-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})+\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})\right\Vert _{V}^{2}\protect\\
 & = & \left\Vert y-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}^{2}+\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})\right\Vert _{V}^{2}+2\left\langle y-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}}),\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})\right\rangle _{V}\protect\\
 & \le & \left\Vert y-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}^{2}
\end{eqnarray*}
}

Then
\[
\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})\right\Vert _{V}^{2}+2\left\langle \epsilon+g^{*}-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}}),\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})\right\rangle _{V}\le0
\]


Rearranging, we get 
\[
\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})\right\Vert _{V}^{2}+2\left\langle g^{*}-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}}),\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})\right\rangle _{V}\le2\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}
\]



\section{Old Theorem 3}

Suppose that if $\|\epsilon\|_{T}\le2\sigma$, then $\mathcal{G}(T)$
satisfies the entropy condition 
\[
\int_{0}^{R}H{}^{1/2}(u,\mathcal{G}(T),\|\cdot\|_{V})du\le\psi_{T}(R)
\]


Furthermore, suppose that

\[
\frac{\psi_{T}\left(a+u\right)}{u^{2}}
\]


is nonincreasing wrt to $u$ for all $u,a>0$ such that $a+u>\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}$.

Then there is some constant $C$ (only dependent on the characteristics
of the sub-gassian errors) such that for all $\delta>0$ such that

\[
\sqrt{n_{V}}\delta^{2}\ge2C\left[\psi_{T}\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2\delta\right)\vee\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2\delta\right)\right]
\]


then

\begin{eqnarray*}
Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\ge\delta\wedge\|\epsilon\|_{V}\le2\sigma\right) & \le & c\exp\left(-\frac{n_{V}\delta^{4}}{c^{2}\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}}\right)+c\exp\left(-\frac{n_{V}\delta^{2}}{c^{2}}\right)+Pr\left(\|\epsilon\|_{T}\ge2\sigma\right)
\end{eqnarray*}


for a constant $c>0$.


\subsubsection*{Proof}

The basic inequality gives us 

\[
\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}\le\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}+2\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}
\]


Note that since $\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\le\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}$,
then 
\begin{eqnarray*}
\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\right)^{2} & \le & \left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}
\end{eqnarray*}


By a peeling argument, we have
\begin{eqnarray*}
Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\ge\delta\right) & = & \sum_{s=0}^{\infty}Pr\left(2^{s}\delta\le\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\le2^{s+1}\delta\right)\\
 & \le & \sum_{s=0}^{\infty}Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\ge2^{s}\delta\wedge\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\le2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\\
 & = & \sum_{s=0}^{\infty}Pr\left(\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\right)^{2}\ge2^{2s}\delta^{2}\wedge\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\le2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\\
 & \le & \sum_{s=0}^{\infty}Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}\ge2^{2s}\delta^{2}\wedge\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\le2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\\
 & \le & \sum_{s=0}^{\infty}Pr\left(\sup_{\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\le2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta}\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}\ge2^{2s-1}\delta^{2}\right)
\end{eqnarray*}


To apply the lemma based on vandegeer corollary 8.3 (see below), we
must check all the conditions are satisfied. 

We choose $\delta$ such that 
\begin{eqnarray*}
\frac{\sqrt{n_{V}}}{8} & \ge & \frac{C}{4\delta^{2}}\left[\psi_{T}\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2\delta\right)\vee\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2\delta\right)\right]\\
 & \ge & \frac{C}{2^{2s+2}\delta^{2}}\left[\psi_{T}\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\vee\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\right]
\end{eqnarray*}


where the second line follows from the assumption that $\psi_{T}(a+u)/u^{2}$
is nonincreasing wrt $u$. Hence we have satisfied the condition in
corollary 8.3. So for all $s=0,1,...$ since

\[
\sqrt{n_{V}}2^{2s-1}\delta^{2}\ge C\left[\psi_{T}\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\vee\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\right]
\]


we have
\[
Pr\left(\sup_{\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\le2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta}\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}\ge2^{2s-1}\delta^{2}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)\le\exp\left(-n_{V}\frac{2^{4s-2}\delta^{4}}{4C^{2}\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)^{2}}\right)
\]


Hence we have
\begin{eqnarray*}
Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\ge\delta\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right) & \le & C\sum_{s=0}^{\infty}\exp\left(-n_{V}\frac{2^{4s-2}\delta^{4}}{4C^{2}\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)^{2}}\right)\\
 & \le & C\sum_{s=0}^{\infty}\exp\left(-n_{V}\frac{2^{4s-2}\delta^{4}}{64C^{2}\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}}\right)\vee\exp\left(-n_{V}\frac{2^{2s}\delta^{2}}{196C^{2}}\right)\\
 & \le & c\exp\left(-\frac{n_{V}\delta^{4}}{c^{2}\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}}\right)+c\exp\left(-\frac{n_{V}\delta^{2}}{c^{2}}\right)
\end{eqnarray*}


for some constant $c$.

Hence we have found for the given $\delta$ choice, we have

\begin{eqnarray*}
Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\ge\delta\wedge\|\epsilon\|_{V}\le2\sigma\right) & \le & c\exp\left(-\frac{n_{V}\delta^{4}}{c^{2}\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}}\right)+c\exp\left(-\frac{n_{V}\delta^{2}}{c^{2}}\right)+Pr\left(\|\epsilon\|_{T}\ge2\sigma\right)
\end{eqnarray*}

\end{document}
