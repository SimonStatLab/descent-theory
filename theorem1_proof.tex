%% LyX 2.1.3 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[english]{article}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage[landscape]{geometry}
\geometry{verbose,tmargin=3cm,bmargin=3cm,lmargin=3cm,rmargin=3cm}
\usepackage{amsbsy}
\usepackage{esint}
\usepackage{babel}
\begin{document}

\title{Training/Validation Split Theorem}

\maketitle
We are interested in bounding the error of the selected model when
tuning penalty parameters by a training validation split. We will
concern ourselves with the error over the observed covariates in the
validation set. Under sufficient entropy conditions, the error of
the selected model will converge to the error of the oracle. 

We will suppose that the data is generated from the model:
\[
y=g^{*}(x)+\epsilon
\]


where $\epsilon$ are independent, sub-gaussian errors. The penalized
regression models are 
\[
\hat{g}(\cdot|\boldsymbol{\lambda})=\arg\min_{g\in\mathcal{G}}L_{T}(g|\boldsymbol{\lambda})
\]


Let the model class after fitting on the training data be 
\[
\mathcal{G}(T)=\left\{ \hat{g}(\cdot|\boldsymbol{\lambda}):\boldsymbol{\lambda}\in\Lambda\right\} 
\]


The selected penalty parameters are
\[
\hat{\boldsymbol{\lambda}}=\arg\min_{\boldsymbol{\lambda}\in\Lambda}\left\Vert y-\hat{g}(\cdot|\boldsymbol{\lambda})\right\Vert _{V}^{2}
\]


Suppose the ``oracle'' penalty parameters are 
\[
\tilde{\boldsymbol{\lambda}}=\arg\min_{\boldsymbol{\lambda}\in\Lambda}\|\hat{g}(\cdot|\boldsymbol{\lambda})-g^{*}\|_{V}
\]


We will provide sharp oracle inequalities of the form
\[
\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\le\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+\delta
\]


The document is organized as follows
\begin{enumerate}
\item Theorem 3 proves the training/validation split under general entropy
conditions. 
\item Theorem 1 applies Theorem 3 to the special case when the fitted functions
are Lipschitz in the penalty parameters
\end{enumerate}

\section{Theorem 3}

Suppose that if $\|\epsilon\|_{T}\le2\sigma$, then $\mathcal{G}(T)$
satisfies the entropy condition 
\[
\int_{0}^{R}H{}^{1/2}(u,\mathcal{G}(T),\|\cdot\|_{V})du\le\psi_{T}(R)
\]


Furthermore, suppose that

\[
\frac{\psi_{T}\left(a+u\right)}{u^{2}}
\]


is nonincreasing wrt to $u$ for all $u,a>0$ such that $a+u>\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}$.

Then there is some constant $C$ (only dependent on the characteristics
of the sub-gassian errors) such that for all $\delta>0$ such that
\[
\sqrt{n_{V}}\delta^{2}\ge2C\left[\psi_{T}\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2\delta\right)\vee\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2\delta\right)\right]
\]


then

\begin{eqnarray*}
Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\ge\delta\wedge\|\epsilon\|_{V}\le2\sigma\right) & \le & c\exp\left(-\frac{n_{V}\delta^{4}}{c^{2}\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}}\right)+c\exp\left(-\frac{n_{V}\delta^{2}}{c^{2}}\right)+Pr\left(\|\epsilon\|_{T}\le2\sigma\right)
\end{eqnarray*}


for a constant $c$.


\subsubsection*{Proof}

The basic inequality gives us 

\[
\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}\le\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}+2\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}
\]


Note that since $\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\le\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}$,
then 
\begin{eqnarray*}
\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\right)^{2} & \le & \left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}
\end{eqnarray*}


By a peeling argument, we have
\begin{eqnarray*}
Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\ge\delta\right) & = & \sum_{s=0}^{\infty}Pr\left(2^{s}\delta\le\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\le2^{s+1}\delta\right)\\
 & \le & \sum_{s=0}^{\infty}Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\ge2^{s}\delta\wedge\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\le2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\\
 & = & \sum_{s=0}^{\infty}Pr\left(\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\right)^{2}\ge2^{2s}\delta^{2}\wedge\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\le2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\\
 & \le & \sum_{s=0}^{\infty}Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}\ge2^{2s}\delta^{2}\wedge\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\le2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\\
 & \le & \sum_{s=0}^{\infty}Pr\left(\sup_{\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\le2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta}\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}\ge2^{2s-1}\delta^{2}\right)
\end{eqnarray*}


To apply the lemma based on vandegeer corollary 8.3 (see below), we
must check all the conditions are satisfied. 

We choose $\delta$ such that 
\begin{eqnarray*}
\frac{\sqrt{n_{V}}}{8} & \ge & \frac{C}{4\delta^{2}}\left[\psi_{T}\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2\delta\right)\vee\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2\delta\right)\right]\\
 & \ge & \frac{C}{2^{2s+2}\delta^{2}}\left[\psi_{T}\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\vee\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2\delta\right)\right]
\end{eqnarray*}


where the second line follows from the assumption that $\psi_{T}(a+u)/u^{2}$
is nonincreasing wrt $u$. Hence we have satisfied the condition in
corollary 8.3. So for all $s=0,1,...$ since

\[
\sqrt{n_{V}}2^{2s-1}\delta^{2}\ge C\left[\psi_{T}\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\vee\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\right]
\]


we have
\[
Pr\left(\sup_{\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\Vert _{V}\le2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta}\left\langle \epsilon,\hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-\hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})\right\rangle _{V}\ge2^{2s-1}\delta^{2}\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)\le\exp\left(-n_{V}\frac{2^{4s-2}\delta^{4}}{4C^{2}\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)^{2}}\right)
\]


Hence we have
\begin{eqnarray*}
Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\ge\delta\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right) & \le & C\sum_{s=0}^{\infty}\exp\left(-n_{V}\frac{2^{4s-2}\delta^{4}}{4C^{2}\left(2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)^{2}}\right)\\
 & \le & C\sum_{s=0}^{\infty}\exp\left(-n_{V}\frac{2^{4s-2}\delta^{4}}{64C^{2}\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}}\right)\vee\exp\left(-n_{V}\frac{2^{2s}\delta^{2}}{196C^{2}}\right)\\
 & \le & c\exp\left(-\frac{n_{V}\delta^{4}}{c^{2}\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}}\right)+c\exp\left(-\frac{n_{V}\delta^{2}}{c^{2}}\right)
\end{eqnarray*}


for some constant $c$.

Hence we have found for the given $\delta$ choice, we have

\begin{eqnarray*}
Pr\left(\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}-\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\ge\delta\wedge\|\epsilon\|_{V}\le2\sigma\right) & \le & c\exp\left(-\frac{n_{V}\delta^{4}}{c^{2}\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}^{2}}\right)+c\exp\left(-\frac{n_{V}\delta^{2}}{c^{2}}\right)+Pr\left(\|\epsilon\|_{T}\le2\sigma\right)
\end{eqnarray*}



\section{Theorem 1}

Let $\Lambda=[n_{V}^{-t_{min}},n_{V}^{t_{max}}]^{J}$.

Suppose that if $\|\epsilon\|_{T}\le2\sigma$, there are constants
$C,\kappa$ such that for any $u>0$, we have for all $\lambda\in\Lambda$
\[
\left\Vert \hat{g}(\cdot|\boldsymbol{\lambda}^{(1)})-\hat{g}(\cdot|\boldsymbol{\lambda}^{(2)})\right\Vert _{V}\le Cn^{\kappa}\|\boldsymbol{\lambda}_{1}-\boldsymbol{\lambda}_{2}\|
\]


Then there are constants $c,c_{1},c_{2}$ s.t. with high probability,
\[
\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\le\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+c_{1}\left(\frac{J\left(1+t_{max}+\kappa\right)\log n_{V}+c_{4}}{n_{V}}\right)^{1/2}+c_{2}\sqrt{\left(\frac{J\left(1+t_{max}+\kappa\right)\log n_{V}+c_{4}}{n_{V}}\right)^{1/2}\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}}
\]



\subsubsection*{Proof}

\textbf{1. Determine entropy bound and properties}

Under the given Lipschitz condition, a $\delta$-cover for $\Lambda$
is a $Cn^{\kappa}\delta$-cover for $\mathcal{G}(T)$. We can therefore
calculate a covering number for $\mathcal{G}(T)$ wrt $\|\cdot\|_{V}$
by using the covering number for $\Lambda$. 
\[
N\left(u,\mathcal{G}(T),\|\cdot\|_{V}\right)\le N\left(\frac{u}{Cn^{\kappa}},\Lambda,\|\cdot\|_{2}\right)
\]


By Lemma param\_covering\_cube, we know that
\begin{eqnarray*}
N\left(u,\Lambda,\|\cdot\|_{2}\right) & \le & \frac{1}{C_{J}}\left(\frac{4\left(\lambda_{max}-\lambda_{min}\right)+2\frac{u}{Cn^{\kappa}}}{\frac{u}{Cn^{\kappa}}}\right)^{J}\\
 & = & \frac{1}{C_{J}}\left(\frac{4\left(n_{V}^{t_{max}}-n_{V}^{-t_{min}}\right)Cn^{\kappa}+2u}{u}\right)^{J}\\
 & \le & \frac{1}{C_{J}}\left(\frac{4Cn_{V}^{t_{\max}+\kappa}+2u}{u}\right)^{J}
\end{eqnarray*}


Hence
\[
H(u,\mathcal{G}(T),\|\cdot\|_{V})\le\log\left[\frac{1}{C_{J}}\left(\frac{4Cn_{V}^{t_{\max}+\kappa}+2u}{u}\right)^{J}\right]
\]


Then

\begin{eqnarray*}
\int_{0}^{R}H{}^{1/2}(u,\mathcal{G}(T),\|\cdot\|_{V})du & \le & \int_{0}^{R}\left[\log\frac{1}{C_{J}}+J\log\left(\frac{4Cn_{V}^{t_{\max}+\kappa}+2u}{u}\right)\right]^{1/2}du\\
 & \le & \int_{0}^{R}\left[\log\frac{1}{C_{J}}+J\log4+J\log\left(\frac{8Cn_{V}^{t_{max}+\kappa}}{u}\right)\right]^{1/2}du\\
 & = & R\int_{0}^{1}\left[\log\frac{1}{C_{J}}+J\log4+J\log\left(\frac{8Cn_{V}^{t_{max}+\kappa}}{Rv}\right)\right]^{1/2}dv\\
 & \le & R\left[\int_{0}^{1}\log\frac{1}{C_{J}}+J\log4+J\log\left(\frac{8Cn_{V}^{t_{max}+\kappa}}{R}\right)+J\log\frac{1}{v}dv\right]^{1/2}\\
 & = & R\left[\log\frac{1}{C_{J}}+J(1+\log4+\log8C)+J\log\left(n_{V}^{t_{max}+\kappa}\right)+J\log\frac{1}{R}\right]^{1/2}
\end{eqnarray*}


The second bound is crazy loose but I think it is okay. It comes from
the fact that 
\[
\log\left(a+b\right)<\log\left(2a\right)+\log(2b)
\]


The third inequality follows from concavity of the square root.

\textbf{2. Apply Theorem 3}

By Theorem 3, there is a constant $C_{0}>0$ such that the oracle
inequality 
\[
\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\le\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+\delta
\]


holds with high probability for all $\delta>0$ such that 
\begin{equation}
\sqrt{n_{V}}\delta^{2}\ge2CR\left(\left[\log\frac{1}{C_{J}}+J(1+\log4+\log8C)+J\log\left(n_{V}^{t_{max}+\kappa}\right)+J\log\frac{1}{R}\right]^{1/2}\vee1\right)
\end{equation}


where $R=2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2\delta$.

Solving for $\delta$ is hard because of the $\log\frac{1}{R}$ term.
Suppose we constrain ourselves to a choice of $\delta>1/n_{V}$ (which
is true for sufficiently large sample sizes since $\delta$ is on
the order of $n_{V}^{-1/2}$ for parametric problems). Then 
\[
R=2\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+2\delta\ge2/n_{V}
\]


Therefore $\log\frac{1}{R}<\log n_{V}$. This allows us to replace
the term $\log\frac{1}{R}$ with $\log n_{V}$.

Then we need to find a $\delta>1/n_{V}$ such that

\begin{equation}
\sqrt{n_{V}}\delta^{2}\ge2C_{0}\left(\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+\delta\right)\left[\left[\log\frac{1}{C_{J}}+J(1+\log4+\log8C)+J\log\left(n_{V}^{t_{max}+\kappa}\right)+J\log n_{V}\right]^{1/2}\vee1\right]
\end{equation}


Now we can solve for $\delta$. Let
\begin{eqnarray*}
K & = & 2C_{0}\left(\left[\log\frac{1}{C_{J}}+J(1+\log4+\log8C)+J\log\left(n_{V}^{t_{max}+\kappa}\right)+J\log n_{V}\right]^{1/2}\right)\vee1\\
 & = & 2C_{0}\left(\left[\log\frac{1}{C_{J}}+J(1+\log4+\log8C)+J\left(1+t_{max}+\kappa\right)\log n_{V}\right]^{1/2}\right)\vee1
\end{eqnarray*}


and 
\[
\omega=\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}
\]


(2) can be expressed as

\[
\sqrt{n_{V}}\delta^{2}-K\delta-K\omega\ge0
\]


We notice that (2) is precisely the quadratic inequality and is satisfied
for $\delta$ such that

\begin{eqnarray*}
\delta & \ge & \frac{K+\sqrt{K^{2}+4K\omega\sqrt{n_{V}}}}{2\sqrt{n_{V}}}
\end{eqnarray*}


\textbf{3. Re-writing the condition on $\delta$ to be more intuitive}

For a more intuitive understanding of this lower bound for $\delta$,
we can use a slightly bigger lower bound: 
\[
\delta\ge c_{1}\frac{K}{\sqrt{n_{V}}}+c_{2}\sqrt{\frac{K}{n_{V}}\omega}
\]


for universal constants $c_{1}=1+\frac{1}{\sqrt{2}}$ and $c_{2}=2\sqrt{2}$.

To see why this holds, note that there are two cases:

Case 1. $K>4\omega\sqrt{n_{V}}$
\begin{eqnarray*}
\frac{K+\sqrt{K^{2}+4K\omega\sqrt{n_{V}}}}{2\sqrt{n_{V}}} & \le & \frac{K+\sqrt{2K^{2}}}{2\sqrt{n_{V}}}\\
 & \le & \frac{\left(1+\sqrt{2}\right)K}{2\sqrt{n_{V}}}
\end{eqnarray*}


Case 2. $K<4\omega\sqrt{n_{V}}$
\begin{eqnarray*}
\frac{K+\sqrt{K^{2}+4K\omega\sqrt{n_{V}}}}{2\sqrt{n_{V}}} & \le & \frac{K+\sqrt{8K\omega\sqrt{n_{V}}}}{2\sqrt{n_{V}}}\\
 & \le & \frac{K}{2\sqrt{n_{V}}}+\sqrt{\frac{8K}{\sqrt{n_{V}}}\omega}
\end{eqnarray*}


Plug this inequality back into (1) to gives us the final result.

Theorem 3 gives us that with high probability 
\[
\left\Vert \hat{g}(\cdot|\hat{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}\le\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}+c_{1}\frac{2C_{0}\left(\left[c+J\left(1+t_{max}+\kappa\right)\log n_{V}\right]^{1/2}\right)\vee1}{\sqrt{n_{V}}}+c_{2}\sqrt{\frac{2C_{0}\left(\left[c+J\left(1+t_{max}+\kappa\right)\log n_{V}\right]^{1/2}\right)\vee1}{n_{V}}\left\Vert \hat{g}(\cdot|\tilde{\boldsymbol{\lambda}})-g^{*}\right\Vert _{V}}
\]


where $c=\log\frac{1}{C_{J}}+J(1+\log4+\log8C)$


\section{Appendix}


\subsection*{Lemma Vandegeer (Based on Vandegeer Corollary 8.3)}

(This lemma is directly out of Vandegeer's Empirical Process book.)

Let $Q_{m}$ be the empirical distributon of $m$ observations at
covariates $x_{i}$.

Suppose $\epsilon$ are $m$ independent sub-gaussian errors. Suppose
the model class $\mathcal{F}(T)$ has elements $\sup_{f\in\mathcal{F}_{n}(T)}\|f\|_{Q_{m}}\le R$
and satisfies
\[
\psi_{T}(R)\ge\int_{0}^{R}H^{1/2}(u,\mathcal{F}(T),\|\cdot\|_{Q_{m}})du
\]


There is $C$ dependent only on the sub-gaussian constants such that
for all $\delta>0$ such that
\[
\sqrt{m}\delta\ge C(\psi_{T}(R)\vee R)
\]


we have 
\[
Pr\left(\sup_{f\in\mathcal{F}_{n}(T)}\left|\frac{1}{m}\sum_{i=1}^{m}\epsilon_{i}f(x_{i})\right|\ge\delta\wedge\|\epsilon\|_{Q_{m}}\le\sigma\right)\le C\exp\left(-\frac{m\delta^{2}}{4C^{2}R^{2}}\right)
\]



\subsection*{Lemma param\_covering\_cube}

Suppose $\Lambda=[\lambda_{min},\lambda_{max}]^{J}$. Then the $\delta$-covering
number is bounded as follows 
\[
N(\delta,\Lambda,\|\cdot\|_{2})\le\frac{1}{C_{J}}\left(\frac{4(\lambda_{max}-\lambda_{min})+2\delta}{\delta}\right)^{J}
\]


where $C_{J}=\frac{\mbox{volume of ball of radius }\rho}{\rho^{J}}$.


\subsubsection*{Proof}

(Essentially the same proof as that for Lemma 2.5 in vandegeer)

Let $C=\{c_{j}\}_{j=1}^{N}\subset\Lambda$ be the largest set s.t.
two distinct points $c_{j_{1}},c_{j_{2}}$ are at least $\delta$
apart. Then balls with radius $\delta$ centered at $C$ cover $\Lambda$.
Hence 
\[
N(\delta,\Lambda,\|\cdot\|_{2})\le N
\]


If we instead consider the balls centered at $C$ but with radius
$\delta/4$, all of these smaller balls must be disjoint and are completely
contained in the box $\Lambda_{bigger}=[\lambda_{min}-\delta/4,\lambda_{max}+\delta/4]^{J}$.
So we know the aggregate volume of these smaller balls is less than
the volume of $\Lambda_{bigger}$.

Hence
\[
NC_{J}(\delta/4)^{J}\le(\lambda_{max}-\lambda_{min}+\delta/2)^{J}
\]



\subsubsection*{Lemma: Application of Bernstein's inequality}

For $n$ independent sub-gaussian RVs $\epsilon$ with constants $\sigma,K$,
the norm is bounded as follows

\[
Pr\left(\|\epsilon\|_{n}\ge2\sigma\right)\le\exp\left(-n\frac{\sigma^{2}}{K}\right)
\]

\end{document}
