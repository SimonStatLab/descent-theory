%% LyX 2.1.3 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[english]{article}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage{geometry}
\geometry{verbose,tmargin=3cm,bmargin=3cm,lmargin=3cm,rmargin=3cm}
\usepackage{amsbsy}
\usepackage{esint}
\usepackage{babel}
\begin{document}

\subsection*{Theorem 3}

Suppose we have sub-gauss errors.

Suppose 
\[
\int_{0}^{R}H{}^{1/2}(u,\mathcal{G}(T),\|\cdot\|_{V})du\le\psi_{T}(R)
\]


Suppose

\[
\frac{\psi_{T}\left(a+u\right)}{u^{2}}
\]


are nonincreasing wrt to $u$ for all $u>0,a>0$.

Then there is some constant $C$ (only dependent on the characteristics
of the sub-gassian errors) such that for all $\delta$ that satisfy
\[
\sqrt{n_{V}}\delta^{2}\ge2C\left[\psi_{T}\left(2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2\delta\right)\vee\left(2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2\delta\right)\right]
\]


we have with high probability that
\[
\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}\le\|\hat{g}_{\tilde{\lambda}}-g^{*}\|_{V}+\delta
\]



\subsubsection*{Proof for Theorem 3}

The basic inequality gives us 

\[
\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}^{2}\le\|\hat{g}_{\tilde{\lambda}}(\cdot|T)-g^{*}\|_{V}^{2}+2\langle\epsilon,\hat{g}_{\hat{\lambda}}-\hat{g}_{\tilde{\lambda}}\rangle_{V}
\]


Note that if $\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}\le\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}$,
then 
\begin{eqnarray*}
\left(\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}-\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}\right)^{2} & \le & \left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}^{2}
\end{eqnarray*}


By a peeling argument, we have
\begin{eqnarray*}
 &  & Pr\left(\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}-\|\hat{g}_{\tilde{\lambda}}-g^{*}\|_{V}\ge\delta\right)\\
 & = & \sum_{s=0}^{\infty}Pr\left(2^{s}\delta\le\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}-\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}\le2^{s+1}\delta\right)\\
 & \le & \sum_{s=0}^{\infty}Pr\left(\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}-\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}\ge2^{s}\delta\wedge\left\Vert \hat{g}_{\hat{\lambda}}-\hat{g}_{\tilde{\lambda}}\right\Vert _{V}\le2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\\
 & = & \sum_{s=0}^{\infty}Pr\left(\left(\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}-\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}\right)^{2}\ge2^{2s}\delta^{2}\wedge\left\Vert \hat{g}_{\hat{\lambda}}-\hat{g}_{\tilde{\lambda}}\right\Vert _{V}\le2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\\
 & \le & \sum_{s=0}^{\infty}Pr\left(\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}^{2}-\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}^{2}\ge2^{2s}\delta^{2}\wedge\left\Vert \hat{g}_{\hat{\lambda}}-\hat{g}_{\tilde{\lambda}}\right\Vert _{V}\le2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\\
 & \le & \sum_{s=0}^{\infty}Pr\left(\sup_{\left\Vert \hat{g}_{\lambda}-\hat{g}_{\tilde{\lambda}}\right\Vert _{V}\le2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2^{s+1}\delta}\langle\epsilon,\hat{g}_{\tilde{\lambda}}-\hat{g}_{\lambda}\rangle_{V}\ge2^{2s-1}\delta^{2}\right)
\end{eqnarray*}


To apply the lemma based on vandegeer corollary 8.3 (see below), we
must check all the conditions are satisfied. 

We have chosen that $\delta$ such that 
\begin{eqnarray*}
\frac{\sqrt{n_{V}}}{8} & \ge & \frac{C}{4\delta^{2}}\left[\psi_{T}\left(2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2\delta\right)\vee\left(2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2\delta\right)\right]\\
 & \ge & \frac{C}{2^{2s+2}\delta^{2}}\left[\psi_{T}\left(2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\vee\left(2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2\delta\right)\right]
\end{eqnarray*}


where the second line follows from the assumption that $\psi_{T}(a+u)/u^{2}$
is nonincreasing wrt $u$. Hence we have satisfied the condition in
corollary 8.3 that 

\[
\sqrt{n_{V}}2^{2s-1}\delta^{2}\ge C\left[\psi_{T}\left(2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\vee\left(2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)\right]
\]


Hence we have
\begin{eqnarray*}
 &  & Pr\left(\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}-\|\hat{g}_{\tilde{\lambda}}-g^{*}\|_{V}\ge\delta\wedge\|\epsilon\|_{V}\le2\sigma\wedge\|\epsilon\|_{T}\le2\sigma\right)\\
 & \le & C\sum_{s=0}^{\infty}\exp\left(-n_{V}\frac{2^{4s-2}\delta^{4}}{4C^{2}\left(2\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+2^{s+1}\delta\right)^{2}}\right)\\
 & \le & C\sum_{s=0}^{\infty}\exp\left(-n_{V}\frac{2^{4s-2}\delta^{4}}{64C^{2}\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}^{2}}\right)\vee\exp\left(-n_{V}\frac{2^{2s}\delta^{2}}{196C^{2}}\right)\\
 & \le & c\exp\left(-\frac{n_{V}\delta^{4}}{c^{2}\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}^{2}}\right)+c\exp\left(-\frac{n_{V}\delta^{2}}{c^{2}}\right)
\end{eqnarray*}


for some constant $c$.

By Bernstein's inequality, we also know
\[
Pr\left(\|\epsilon\|_{T}\ge2\sigma\right)\le\exp\left(-n_{T}\frac{\sigma^{2}}{K}\right)
\]


and similarly for $Pr\left(\|\epsilon\|_{V}\ge2\sigma\right)$.

Hence we have found for the given $\delta$ choice, we have

\begin{eqnarray*}
 &  & Pr\left(\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}-\|\hat{g}_{\tilde{\lambda}}-g^{*}\|_{V}\ge\delta\right)\\
 & \le & c\exp\left(-\frac{n_{V}\delta^{4}}{c^{2}\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}^{2}}\right)+c\exp\left(-\frac{n_{V}\delta^{2}}{c^{2}}\right)+\exp\left(-n_{T}\frac{\sigma^{2}}{K}\right)+\exp\left(-n_{V}\frac{\sigma^{2}}{K}\right)
\end{eqnarray*}



\subsection*{Theorem 1 (Corollary to Theorem 3)}

Let $\Lambda=[n^{-t_{min}},n^{t_{max}}]^{J}$.

Suppose that if $\|\epsilon\|_{T}\le2\sigma$, there are constants
$C,\kappa$ such that for any $u>0$, we have for all $\lambda\in\Lambda$
\[
\|\hat{g}_{\boldsymbol{\lambda}_{1}}-\hat{g}_{\boldsymbol{\lambda}_{2}}\|_{V}\le\frac{1}{C}n^{-\kappa}\|\boldsymbol{\lambda}_{1}-\boldsymbol{\lambda}_{2}\|
\]


Then there are constants $c,c_{1},c_{2}$ s.t. with high probability,
\[
\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}\le\|\hat{g}_{\tilde{\lambda}}-g^{*}\|_{V}+\frac{c_{1}\left(J(\log n_{V}+c_{2})\right)^{1/2}}{\sqrt{n_{V}}}+\sqrt{c\left(J(\log n_{V}+c_{2})\right)^{1/2}\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}n_{V}^{-1/2}}
\]



\subsubsection*{Proof}

By Lemma param\_covering\_cube, we have
\begin{eqnarray*}
N\left(u,\mathcal{G}(T),\|\cdot\|_{V}\right) & \le & N\left(Cn^{\kappa}u,\Lambda,\|\cdot\|_{2}\right)\\
 & \le & \frac{1}{C_{J}}\left(\frac{4\left(\lambda_{max}-\lambda_{min}\right)+2Cn^{\kappa}u}{Cn^{\kappa}u}\right)^{J}\\
 & \le & \frac{1}{C_{J}}\left(\frac{4n^{t_{\max}-\kappa}+2Cu}{Cu}\right)^{J}
\end{eqnarray*}
Hence
\[
H(u,\mathcal{G}(T),\|\cdot\|_{V})\le\log\left[\frac{1}{C_{J}}\left(\frac{4n^{t_{max}}+2Cu}{Cu}\right)^{J}\right]
\]


Then
\begin{eqnarray*}
\int_{0}^{R}H{}^{1/2}(u,\mathcal{G}(T),\|\cdot\|_{V})du & \le & \int_{0}^{R}\left[\log\frac{1}{C_{J}}+J\log\left(\frac{2n^{t_{max}-\kappa}+2Cu}{Cu}\right)\right]^{1/2}du\\
 & < & \int_{0}^{R}\left[\log\frac{1}{C_{J}}+J\log4+J\log\left(\frac{4n^{t_{max}-\kappa}}{Cu}\right)\right]^{1/2}du\\
 & = & R\int_{0}^{1}\left[\log\frac{1}{C_{J}}+J\log4+J\log\left(\frac{4n^{t_{max}-\kappa}}{CRv}\right)\right]^{1/2}dv\\
 & \le & R\left[\int_{0}^{1}\log\frac{1}{C_{J}}+J\log4+J\log\left(\frac{4n^{t_{max}-\kappa}}{CRv}\right)dv\right]^{1/2}\\
 & = & R\left[\log\frac{1}{C_{J}}+J(1+\log4)+J\log\left(\frac{4n^{t_{max}-\kappa}}{C}\right)+J\log\frac{1}{R}\right]^{1/2}\\
 & \le & R\left(\left[\log\frac{1}{C_{J}}+J(1+\log4)+J\log\left(\frac{4n^{t_{max}-\kappa}}{C}\right)\right]^{1/2}+\sqrt{J\log\frac{1}{R}\vee0}\right)
\end{eqnarray*}


The second bound is crazy loose (but is okay I think). The third inequality
follows from concavity of the square root.

The term $\log\frac{1}{R}$ is nasty. When choosing $\delta$, we
will replace it with $\log n_{V}$ since for all $R\ge\frac{1}{n_{V}}$,
we have 
\[
\log\frac{1}{R}\vee0\le\log n_{V}
\]


Now apply Theorem 3. If $\delta$ is chosen such that 
\begin{equation}
\sqrt{n_{V}}\delta^{2}\ge2C\left(\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}+\delta\right)\left(\left[\log\frac{1}{C_{J}}+J(1+\log4)+J\log\left(\frac{4n^{t_{max}-\kappa}}{C}\right)\right]^{1/2}+\sqrt{J\log n_{V}}\right)
\end{equation}


then with high probability, we have

\begin{equation}
\left\Vert \hat{g}_{\hat{\lambda}}-g^{*}\right\Vert _{V}\le\|\hat{g}_{\tilde{\lambda}}-g^{*}\|_{V}+\delta
\end{equation}


We can combine the two inequalities. If we let
\[
K=c\left(\left[\log\frac{1}{C_{J}}+J(1+\log4)+J\log\left(\frac{4n^{t_{max}-\kappa}}{C}\right)\right]^{1/2}+\sqrt{J\log n_{V}}\right)
\]


and 
\[
\omega=\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}
\]


Then (1) can be expressed as

\[
\sqrt{n_{V}}\delta^{2}-K\delta-K\omega\ge0
\]


We notice that (1) is precisely the quadratic inequality and is satisfied
for $\delta$ such that

\begin{eqnarray*}
\delta & \ge & \frac{K+\sqrt{K^{2}+4K\omega\sqrt{n_{V}}}}{2\sqrt{n_{V}}}\\
 & \ge & \frac{K}{\sqrt{n_{V}}}+\sqrt{K\left\Vert \hat{g}_{\tilde{\lambda}}-g^{*}\right\Vert _{V}n_{V}^{-1/2}}
\end{eqnarray*}


where the second inequality is provided for a more intuitive understanding.
Plug this inequality back into (2) to get the final result.


\subsection*{Lemma (Based on Vandegeer Corollary 8.3)}

Let $Q_{m}$ be the empirical distributon of $m$ observations at
covariates $x_{i}$.

Suppose $\epsilon$ are $m$ independent sub-gaussian errors. Suppose
the model class $\mathcal{F}(T)$ has elements $\sup_{f\in\mathcal{F}_{n}(T)}\|f\|_{Q_{m}}\le R$
and satisfies
\[
\psi_{T}(R)\ge\int_{0}^{R}H^{1/2}(u,\mathcal{F}(T),\|\cdot\|_{Q_{m}})du
\]


There is $C$ dependent only on the sub-gaussian constants such that
for all $\delta>0$ such that
\[
\sqrt{m}\delta\ge C(\psi_{T}(R)\vee R)
\]


we have 
\[
Pr\left(\sup_{f\in\mathcal{F}_{n}(T)}\left|\frac{1}{m}\sum_{i=1}^{m}\epsilon_{i}f(x_{i})\right|\ge\delta\wedge\|\epsilon\|_{Q_{m}}\le2\sigma\right)\le C\exp\left(-\frac{m\delta^{2}}{4C^{2}R^{2}}\right)
\]



\subsection*{Lemma param\_covering\_cube}

Suppose we have $\Lambda=[\lambda_{min},\lambda_{max}]^{J}$, we have
\[
N(\delta,\Lambda,\|\cdot\|_{2})\le\frac{1}{C_{J}}\left(\frac{4(\lambda_{max}-\lambda_{min})+2\delta}{\delta}\right)^{J}
\]



\subsubsection*{Proof}

(Based on Lemma 2.5 in vandegeer)

Let $C=\{c_{j}\}_{j=1}^{N}\subset\Lambda$ be the largest set s.t.
two distinct points $c_{j_{1}},c_{j_{2}}$ are at least $\delta$
apart. Then balls with radius $\delta$ centered at $C$ cover $\Lambda$.
Hence 
\[
N(\delta,\Lambda,\|\cdot\|_{2})\le N
\]


If we instead consider the balls centered at $C$ but with radius
$\delta/4$, then the balls must be disjoint and are completely contained
in the box $[\lambda_{min}-\delta/4,\lambda_{max}+\delta/4]^{J}$.
So we know the aggregate volume of these smaller balls is less than
the volume of the box.

Recall the volume of a ball with radius $\rho$ is $C_{J}\rho^{J}$
(where $C_{J}$ is a constant dependent on dimension $J$). Hence
\[
NC_{J}(\delta/4)^{J}\le(\lambda_{max}-\lambda_{min}+\delta/2)^{J}
\]



\subsection*{Lemma: Lipschitz Definition Equivalence}

The following two conditions are equivalent:
\begin{enumerate}
\item For all $u>0$ and any $\lambda^{(1)},\lambda^{(2)}$ that satisfy
\[
\|\lambda^{(1)}-\lambda^{(2)}\|\le Cu
\]

\end{enumerate}
then 
\[
\|\hat{g}(\cdot|\lambda^{(1)})-\hat{g}(\cdot|\lambda^{(2)})\|_{D}\le u
\]

\begin{enumerate}
\item $\hat{g}(\cdot|\lambda)$ is $1/C$-Lipschitz in $\lambda$: 
\[
\|\hat{g}(\cdot|\lambda^{(1)})-\hat{g}(\cdot|\lambda^{(2)})\|_{D}\le\frac{1}{C}\|\lambda^{(1)}-\lambda^{(2)}\|
\]

\end{enumerate}

\subsubsection*{Proof}

It is clear that Condition 2 implies Condition 1. 

To show Condition 1 implies Condition 2, suppose for any $\lambda^{(1)},\lambda^{(2)}$,
we have 
\[
\|\lambda^{(1)}-\lambda^{(2)}\|=d=C\frac{d}{C}
\]


Then 
\[
\|\hat{g}(\cdot|\lambda^{(1)})-\hat{g}(\cdot|\lambda^{(2)})\|_{D}\le\frac{d}{C}=\frac{1}{C}\|\lambda^{(1)}-\lambda^{(2)}\|
\]

\end{document}
